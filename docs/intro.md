## Введение

### Установка ПО

1. Выполните установку [OpenLane](https://github.com/The-OpenROAD-Project/OpenLane) или его обновленной версии [LibreLane](https://github.com/librelane/librelane) на свой компьютер, пользуясь инструкцией из репозитория соответствующего проекта.
Проект [OpenLane](https://github.com/The-OpenROAD-Project/OpenLane) более не поддерживается, поэтому рекомендуется использовать [LibreLane](https://github.com/librelane/librelane), так как он включает актуальные версии САПР и более прост в установке.
2. Скачайте репозиторий практической работы на свой компьютер и перенесите папку `vlsi_be_labs` в папку, в которой установлен [LibreLane](https://github.com/librelane/librelane).

### Знакомство с проектом

3. Перейдите в папку `vlsi_be_labs`. Рассмотрим её структуру:

    - `lefs` — директория, содержащая технологический LEF файл `skywater.lef`, а также файл `sky130_fd_sc_hd.lef` с LEF для каждого из библиотечных элементов.
    - `lib` — директория, содержащая единый LIB файл для всех ячеек: `sky130_fd_sc_hd_tt_025C_1v80.lib`.
    - `scr` — директория, содержащая скрипты. Имеет поддиректории:
        - `syn` — директория, содержащая единый скрипт для логического синтеза `syn.tcl`;
        - `layout` — директория, содержащая скрипты, необходимые для разработки топологии;
        - `sdc` — директория, содержащая файл временных ограничений `const.sdc`, который будет использоваться на этапе разработки топологии.
    - `gds` — директория, содержащая скрипты, необходимые для генерации финального GDS файла с помощью САПР Magic.
    - `skywater-pdk` — директория, содержащая файл `lef2gds.map`, позволяющий сопоставить названия слоев из Tech LEF файла с номерами слоёв в GDS файле, поддиректорию `cells` с характеризующими файлами для каждой ячейки и поддиректорию `libs.tech` со вспомогательными файлами для генерации GDS.
    - `verilog` — директория, содержащая RTL-модель проекта в формате Verilog.
    - `work` — рабочая директория, содержащая соответствующие пустые поддиректории для выполнения каждого этапа работы. В эти поддиректории будут выписываться результаты выполнения.

### Знакомство с RTL-моделью

4. Перейдите в директорию `verilog` и откройте файл `seven_segment_seconds.v`.

   Проведите краткий анализ RTL модели блока: обратите внимание на общий размер файла, количество модулей, наличие или отсутствие последовательностной логики. Также оцените общее количество входов и выходов.  
   Если вы обладаете достаточным знанием Verilog, постарайтесь определить функциональность блока.

### Просмотр LEF и GDS файлов в KLayout

5. Вернитесь в корневую директорию OpenLane/LibreLane. Запустите в этой папке терминал. Затем активируйте среду OpenLane/LibreLane. В случае nix-версии LibreLane (рекомендуемая авторами проекта версия установки), для активации необходимо выполнить команду:

   ```bash
   nix-shell --pure shell.nix
   ```

   После выполнения этой команды становятся доступны используемые в данной работе САПР в рамках LibreLane. Дальнейшая работа будет выполняться в этом терминале. Если по какой-то причине данная сессия была завершена, повторите данный пункт.

6. Перейдите в папку, содержащую файлы, характеризующие ячейку AND, с помощью команды:

   ```bash
   cd vlsi_be_labs/skywater-pdk/cells/and2
   ```

7. Запустите KLayout, выполнив команду:

   ```bash
   klayout
   ```

   В результате откроется графический интерфейс САПР KLayout:

   ![](images/klayout_win.png)

8. В графическом интерфейсе KLayout выберите File → Open, в списке предложенных файлов выберите `sky130_fd_sc_hd_and2_0.gds` и нажмите Open.  
В результате вы увидите GDS-представление элемента.
![](images/view_gds.png)

Обратите внимание на панель Layers справа. В этой панели приведен список слоев GDS. Каждый слой характеризуется номером слоя (первое число) и, так называемым, Data Type (второе число).

9. В графическом интерфейсе KLayout выберите File->Open In New Panel, в списке предложенных файлов выберите sky130_fd_sc_hd_and2_0.lef и нажмите Open.
В результате в KLayout открыты 2 вкладки, содержащие LEF и GDS файлы для одной ячейки, что позволяет сравнить эти 2 представления.
![](images/view_lef.png)

Обратите внимание что LEF представление ячейки имеет меньшее количество слоев. Это видно как по списку слоев, так и по, непосредственно, изображению. Основная задача абстрактного lef представления - предоставить САПР данные о размере элемента и пинов ввода-вывода.

10. Существует возможность отобразить отдельные слои как в LEF, так и в GDS формате для их детального анализа.  
- Правой кнопкой мыши нажмите на один из слоев и выберете "Show Only Selected". 
 - Чтобы выделить отобразить несколько слоев зажмите "Ctrl" затем выделите левой кнопкой мыши нужные слои. Правой кнопкой мыши нажмите на один из слоев и выберете "Show Only Selected".  
- Чтобы вернуться к отображению всех слоев выберете "Show All".

11. В LEF файле просмотрите слои, в названиях которых есть слово "PIN". Горизонтальные страйпы (полосы) в верхней и нижней части ячейки - пины для подключения питания и земли соответственно.

![](images/pwr_stripes.png)

Другой же слой со сложной конфигурацией - сигнальные пины. 

![](images/signal_pins.png)

**Дополнительное задание 1**
 Ознакомьте со слоями, название которых включает слово "LABEL"

 **Дополнительное задание 2**

 Найдите рассмотренные выше слои на GDS представлении ячейки.
 

 **Заключение**
 На этом мы закончили первоначальное знакомство с LEF и GDS файлами, поэтому закройте KLayout и в терминале вернитесь в корневую папку проекта с помощью команды:

```bash
cd ../../..
```